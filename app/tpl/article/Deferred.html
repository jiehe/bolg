<div class="md-section-divider"></div>

<div class="md-section-divider"></div>

<h1 id="deferred" data-anchor-id="6dr9">Deferred</h1>

<p data-anchor-id="rdbr"><code>前端</code></p>

<hr>

<p data-anchor-id="z7oz">在此输入正文</p>

<p data-anchor-id="d7ql">$.Deferred().resolve('abc').promise().then(function(b){console.log(b)},function(a){console.log(a)})</p>

<div class="md-section-divider"></div>

<pre class="prettyprint linenums prettyprinted" data-anchor-id="tuzv"><ol class="linenums"><li class="L0"><code><span class="kwd">then</span><span class="pun">((</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">respData</span><span class="pun">,</span><span class="pln"> status</span><span class="pun">,</span><span class="pln"> xhr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">  </span><span class="kwd">var</span><span class="pln"> resData</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">  resData </span><span class="pun">=</span><span class="pln"> respData</span><span class="pun">.</span><span class="pln">response_body</span><span class="pun">.</span><span class="pln">response</span><span class="pun">;</span></code></li><li class="L3"><code><span class="pln">  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="str">"message"</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> respData</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Deferred</span><span class="pun">().</span><span class="pln">reject</span><span class="pun">(</span><span class="pln">respData</span><span class="pun">.</span><span class="pln">message</span><span class="pun">).</span><span class="pln">promise</span><span class="pun">();</span></code></li><li class="L5"><code><span class="pln">  </span><span class="pun">}</span></code></li><li class="L6"><code><span class="pln">  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">respData</span><span class="pun">.</span><span class="pln">response_header</span><span class="pun">.</span><span class="pln">rspcode </span><span class="pun">!==</span><span class="pln"> </span><span class="str">"0000"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Deferred</span><span class="pun">().</span><span class="pln">reject</span><span class="pun">(</span><span class="pln">respData</span><span class="pun">.</span><span class="pln">response_header</span><span class="pun">.</span><span class="pln">rspdesc</span><span class="pun">).</span><span class="pln">promise</span><span class="pun">();</span></code></li><li class="L8"><code><span class="pln">  </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Deferred</span><span class="pun">().</span><span class="pln">resolve</span><span class="pun">(</span><span class="pln">resData</span><span class="pun">).</span><span class="pln">promise</span><span class="pun">();</span></code></li><li class="L0"><code><span class="pln">  </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pun">}),</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">jqXHR</span><span class="pun">,</span><span class="pln"> textStatus</span><span class="pun">,</span><span class="pln"> errorThrown</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">  util</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"调用 "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> bipcode </span><span class="pun">+</span><span class="pln"> </span><span class="str">" 接口失败"</span><span class="pun">);</span></code></li><li class="L3"><code><span class="pln">  </span><span class="kwd">return</span><span class="pln"> $</span><span class="pun">.</span><span class="typ">Deferred</span><span class="pun">().</span><span class="pln">reject</span><span class="pun">(</span><span class="pln">util</span><span class="pun">.</span><span class="pln">showAjaxErrorInfo</span><span class="pun">(</span><span class="pln">jqXHR</span><span class="pun">,</span><span class="pln"> textStatus</span><span class="pun">,</span><span class="pln"> errorThrown</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)).</span><span class="pln">promise</span><span class="pun">();</span></code></li><li class="L4"><code><span class="pun">});</span></code></li><li class="L5"><code><span class="pun">}</span><span class="pln">    </span><span class="pun">})</span></code></li><li class="L6"><code><span class="pun">;</span></code></li><li class="L7"><code><span class="kwd">return</span><span class="pln"> m</span><span class="pun">;</span></code></li><li class="L8"><code><span class="pun">})</span></code></li><li class="L9"><code><span class="pun">;</span></code></li></ol></pre>
